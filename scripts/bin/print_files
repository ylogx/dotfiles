#!/bin/bash

# Function to print file content with the format
print_file_content() {
    local filepath=$1
    echo "$filepath:"
    cat "$filepath"
    echo -e "\n"
}

# List of file extensions to include
include_extensions=("py" "yml" "toml" "md" "txt" "Dockerfile")

# Parse command line options
print_content=true
while getopts "n" opt; do
    case $opt in
        n)
            print_content=false
            ;;
        *)
            echo "Usage: $0 [-n]"
            echo "  -n   Print only file names"
            exit 1
            ;;
    esac
done

# Iterate through each file in the directory structure
find . -type f | while read -r filepath; do
    filename=$(basename -- "$filepath")
    extension="${filename##*.}"
    
    # Check if the file has an extension or is a Dockerfile
    if [[ " ${include_extensions[@]} " =~ " ${extension} " ]] || [[ "$filename" == "Dockerfile" ]]; then
        echo "$filepath"
        if $print_content; then
            print_file_content "$filepath"
        fi
    fi
done

